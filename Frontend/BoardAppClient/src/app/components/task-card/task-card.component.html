<div class="task-card"
     [class.overdue]="isOverdue()"
     [class.dragging]="isDragging"
     draggable="true"
     (dragstart)="onDragStart($event)"
     (dragend)="onDragEnd($event)">
  <div class="task-header">
    <h3 class="task-title">{{ task.title }}</h3>
    <div class="task-actions">
      <button class="btn-icon" (click)="onEdit()" title="Редактировать">
        <i class="material-icons">edit</i>
      </button>
      <button class="btn-icon" (click)="onDelete()" title="Удалить">
        <i class="material-icons">delete</i>
      </button>
    </div>
  </div>

  <div class="task-content" *ngIf="task.description">
    <p class="task-description">{{ task.description }}</p>
  </div>

  <div class="task-meta">
    <div class="task-priority">
      <span class="priority-badge"
            [style.background-color]="getPriorityColor(task.priority)">
        {{ getPriorityLabel(task.priority) }}
      </span>
    </div>

    <div class="task-assignee" *ngIf="task.assignee">
      <i class="material-icons">person</i>
      <span>{{ task.assignee }}</span>
    </div>

    <div class="task-due-date" *ngIf="task.dueDate">
      <i class="material-icons">schedule</i>
      <span [class.overdue]="isOverdue()">{{ formatDate(task.dueDate) }}</span>
    </div>
  </div>

  <div class="task-tags" *ngIf="task.tags && task.tags.length > 0">
    <span class="tag" *ngFor="let tag of task.tags">{{ tag }}</span>
  </div>

  <div class="task-footer">
        <div class="move-task-dropdown">
      <button class="btn-move" (click)="toggleDropdown()">
        <i class="material-icons">swap_horiz</i>
        Переместить
      </button>
      <div class="dropdown-menu" [class.show]="isDropdownOpen" #moveDropdown>
        <button class="dropdown-item"
                *ngFor="let status of taskStatuses"
                (click)="onMoveTask(status.status); closeDropdown()"
                [disabled]="status.status === task.status">
          <i class="material-icons">{{ status.icon }}</i>
          {{ status.label }}
        </button>
      </div>
    </div>

    <div class="task-dates">
      <small>Создано: {{ formatDate(task.createdAt) }}</small>
    </div>
  </div>
</div>
